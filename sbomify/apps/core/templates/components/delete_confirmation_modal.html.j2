<template x-teleport="body">
    <div x-show="{{ modal_id }}"
         x-ref="modalOverlay"
         x-init="window.initDeleteModal && window.initDeleteModal('{{ modal_id }}', $el)"
         class="delete-modal-overlay"
         tabindex="-1"
         role="dialog"
         aria-modal="true"
         aria-labelledby="delete-modal-title-{{ modal_id }}"
         @click="{{ modal_id }} = false"
         @keydown.escape.window="{{ modal_id }} = false"
         @keydown.tab.prevent="window.handleTabKey($event)"
         x-transition:enter="transition ease-out duration-150"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         style="display: none">
        <div class="delete-modal" @click.stop>
            <div class="delete-modal-header">
                <div class="delete-modal-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 id="delete-modal-title-{{ modal_id }}" class="delete-modal-title">{{ title|default:'Confirm Delete' }}</h3>
                <button type="button"
                        class="delete-modal-close"
                        @click="{{ modal_id }} = false"
                        x-ref="closeButton"
                        aria-label="Close modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="delete-modal-body">
                <p class="delete-modal-message">
                    {{ message|default:'Are you sure you want to delete' }}
                    {% if item_name %}<span class="delete-modal-name">{{ item_name }}</span>?{% endif %}
                </p>
                <p class="delete-modal-warning">
                    {{ warning_message|default:'This action cannot be undone and will permanently remove the item from the system.' }}
                </p>
            </div>
            <div class="delete-modal-footer">
                <button type="button"
                        class="delete-modal-button delete-modal-button--secondary"
                        @click="{{ modal_id }} = false"
                        x-ref="cancelButton">{{ cancel_text|default:'Cancel' }}</button>
                {# Scripts moved to apps/core/js/components/delete-modal.ts #}
                {# djlint:off #}
            <button type="button" 
                    class="delete-modal-button delete-modal-button--danger"
                    x-ref="deleteButton"
                    {% if hx_url %}
                    x-data="window.getDeleteModalData({
                        modalId: '{{ modal_id }}',
                        hxUrl: '{{ hx_url }}',
                        hxMethod: '{{ hx_method|default:'DELETE'|upper }}',
                        successMessage: '{{ success_message|default:'Deleted successfully!' }}',
                        csrfToken: '{{ csrf_token }}',
                        redirectUrl: '{{ redirect_url|default:'' }}'
                    })"
                    @click="handleDelete()"
                    :disabled="isLoading"
                    :class="{ 'opacity-75': isLoading, 'cursor-not-allowed': isLoading }"
            {% elif confirm_callback %}
                @click="{{ confirm_callback }}"
            {% endif %}
            >
            {% if hx_url %}
            <i class="fas fa-spinner fa-spin me-2" x-show="isLoading" style="display: none;"></i>
            <i class="fas fa-trash me-2" x-show="!isLoading"></i>
            <span x-text="isLoading ? 'Deleting...' : '{{ confirm_text|default:'Delete' }}'"></span>
            {% else %}
            <i class="fas fa-trash me-2"></i>
            {{ confirm_text|default:'Delete' }}
            {% endif %}
            </button>
                {# djlint:on #}
            </div>
        </div>
    </div>
</template>
