{% comment %}
Pending Items Component
Displays pending access requests and team invitations with inline actions.

Parameters:
- pending_access_requests: List of access request objects
- pending_invitations: List of invitation objects
- access_requests_url: URL to manage access requests
- invitations_url: URL to manage invitations
{% endcomment %}
<div class="tw-card h-full flex flex-col">
    <div class="px-6 py-4 border-b border-border">
        <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold text-text flex items-center gap-2 m-0">
                <i class="fas fa-bell text-warning"></i>
                Pending Items
            </h3>
            {% if pending_access_requests or pending_invitations %}
                <span class="w-2 h-2 bg-warning rounded-full"></span>
            {% endif %}
        </div>
    </div>
    <div class="p-6 flex-1 overflow-hidden">
        {% if pending_access_requests or pending_invitations %}
            <div class="space-y-4 max-h-[320px] overflow-y-auto pr-2">
                {# Access Requests #}
                {% if pending_access_requests %}
                    {% for request in pending_access_requests|slice:":3" %}
                        <div class="p-3 rounded-lg bg-background/50 border border-border">
                            <div class="flex items-start justify-between gap-3">
                                <div class="flex items-start gap-3 min-w-0">
                                    <div class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-user-plus text-primary text-sm"></i>
                                    </div>
                                    <div class="min-w-0">
                                        <p class="text-sm font-medium text-text truncate">Access Request</p>
                                        <p class="text-xs text-text-muted truncate">
                                            {% if request.email %}
                                                {{ request.email }}
                                            {% elif request.requester_name %}
                                                {{ request.requester_name }}
                                            {% else %}
                                                Unknown
                                            {% endif %}
                                        </p>
                                        {% if request.created_at %}
                                            <p class="text-xs text-text-muted mt-1">
                                                <i class="fas fa-clock mr-1"></i>{{ request.created_at|timesince }} ago
                                            </p>
                                        {% endif %}
                                    </div>
                                </div>
                                {% if access_requests_url %}
                                    <a href="{{ access_requests_url }}"
                                       class="text-xs text-primary hover:text-primary-dark font-medium whitespace-nowrap">
                                        Review
                                    </a>
                                {% else %}
                                    <span class="text-xs text-text-muted font-medium whitespace-nowrap">Review</span>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                    {% if pending_access_requests|length > 3 %}
                        <a href="{{ access_requests_url }}"
                           class="text-xs text-text-muted hover:text-primary block text-center">
                            View more access requests
                        </a>
                    {% endif %}
                {% endif %}
                {# Team Invitations #}
                {% if pending_invitations %}
                    {% for inv in pending_invitations|slice:":3" %}
                        <div class="p-3 rounded-lg bg-background/50 border border-border">
                            <div class="flex items-start justify-between gap-3">
                                <div class="flex items-start gap-3 min-w-0">
                                    <div class="w-8 h-8 rounded-full bg-purple-500/10 flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-envelope text-purple-500 text-sm"></i>
                                    </div>
                                    <div class="min-w-0">
                                        <p class="text-sm font-medium text-text truncate">Workspace Invitation</p>
                                        <p class="text-xs text-text-muted truncate">{{ inv.team_name }}</p>
                                        <p class="text-xs text-text-muted mt-1">
                                            <span class="px-1.5 py-0.5 bg-border/50 rounded text-xs">{{ inv.role|title }}</span>
                                        </p>
                                    </div>
                                </div>
                                <div class="flex flex-col gap-1">
                                    <form method="post"
                                          action="{% url 'core:accept_user_invitation' inv.id %}"
                                          hx-boost="false">
                                        {% csrf_token %}
                                        <button type="submit"
                                                class="text-xs text-success hover:text-success/80 font-medium">
                                            Accept
                                        </button>
                                    </form>
                                    <form method="post"
                                          action="{% url 'core:reject_user_invitation' inv.id %}"
                                          hx-boost="false">
                                        {% csrf_token %}
                                        <button type="submit"
                                                class="text-xs text-danger hover:text-danger/80 font-medium">
                                            Decline
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                    {% if pending_invitations|length > 3 %}
                        {% if invitations_url %}
                            <a href="{{ invitations_url }}"
                               class="text-xs text-text-muted hover:text-primary block text-center">
                                View more invitations
                            </a>
                        {% endif %}
                    {% endif %}
                {% endif %}
            </div>
        {% else %}
            <div class="flex flex-col items-center justify-center py-8 text-center">
                <div class="w-12 h-12 rounded-full bg-success/10 flex items-center justify-center mb-3">
                    <i class="fas fa-check text-success text-xl"></i>
                </div>
                <p class="text-text-muted text-sm">All caught up!</p>
                <p class="text-text-muted text-xs mt-1">No pending items require your attention</p>
            </div>
        {% endif %}
    </div>
</div>
