{# Public Product Identifiers - server-rendered #}
{% load static %}
{% if product_identifiers %}
    <div class="public-section" x-data="productIdentifiersBarcodes()">
        <div class="tw-card">
            <div class="px-6 py-4 border-b border-border">
                <h4 class="text-lg font-semibold text-text flex items-center gap-2 m-0">
                    <i class="fas fa-fingerprint text-primary"></i>Product Identifiers
                </h4>
            </div>
            <div class="p-6">
                <div class="overflow-x-auto">
                    <table class="tw-table w-full text-sm">
                        <thead>
                            <tr class="bg-border/30">
                                <th class="text-left py-3 px-4 font-medium text-text-muted">Type</th>
                                <th class="text-left py-3 px-4 font-medium text-text-muted">Value</th>
                                <th class="text-center py-3 px-4 font-medium text-text-muted">Barcode</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for identifier in product_identifiers %}
                                <tr class="hover:bg-border/10">
                                    <td class="py-3 px-4">
                                        <span class="px-2 py-1 text-xs font-medium rounded bg-border/50 text-text">{{ identifier.identifier_type_display }}</span>
                                    </td>
                                    <td class="py-3 px-4">
                                        <code class="text-primary bg-primary/5 px-2 py-0.5 rounded">{{ identifier.value }}</code>
                                    </td>
                                    <td class="py-3 px-4 text-center">
                                        {% if identifier.identifier_type in barcode_types %}
                                            <div class="barcode-wrapper inline-block"
                                                 x-init="renderBarcode('{{ identifier.id }}', '{{ identifier.value|escapejs }}', '{{ identifier.identifier_type }}')">
                                                <svg data-barcode-id="{{ identifier.id }}"
                                                     class="barcode-svg max-w-[150px] h-auto"
                                                     x-show="barcodeRendered['{{ identifier.id }}'] && !barcodeErrors['{{ identifier.id }}']">
                                                </svg>
                                                <span x-show="!barcodeRendered['{{ identifier.id }}'] && !barcodeErrors['{{ identifier.id }}']"
                                                      class="text-text-muted">
                                                    <i class="fas fa-spinner fa-spin"></i>
                                                </span>
                                                <span x-show="barcodeErrors['{{ identifier.id }}']"
                                                      class="px-2 py-1 text-xs rounded bg-border/50 text-text-muted">
                                                    <i class="fas fa-info-circle mr-1"></i>Not Applicable
                                                </span>
                                            </div>
                                        {% else %}
                                            <span class="px-2 py-1 text-xs rounded bg-border/50 text-text-muted">
                                                <i class="fas fa-info-circle mr-1"></i>Not Applicable
                                            </span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endif %}
