{# Public Product Identifiers - server-rendered #}
{% load static %}
{% if product_identifiers %}
    <div class="public-section" x-cloak x-data="productIdentifiersBarcodes()">
        <div class="bg-white rounded-lg shadow-sm">
            <div class="px-6 py-4 border-b">
                <h4 class="text-lg font-semibold">
                    <i class="fas fa-fingerprint"></i>Product Identifiers
                </h4>
            </div>
            <div class="p-6">
                <div class="overflow-x-auto">
                    <table class="w-full mb-0 public-table">
                        <thead class="bg-gray-100">
                            <tr class="border-b">
                                <th class="text-left py-2">Type</th>
                                <th class="text-left py-2">Value</th>
                                <th class="text-center py-2">Barcode</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for identifier in product_identifiers %}
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2">
                                        <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-700">{{ identifier.identifier_type_display }}</span>
                                    </td>
                                    <td class="py-2">
                                        <code class="text-brand-primary">{{ identifier.value }}</code>
                                    </td>
                                    <td class="text-center py-2">
                                        {% if identifier.identifier_type in barcode_types %}
                                            <div class="barcode-wrapper identifier-card-barcode"
                                                 x-init="renderBarcode('{{ identifier.id }}', '{{ identifier.value|escapejs }}', '{{ identifier.identifier_type }}')">
                                                <svg data-barcode-id="{{ identifier.id }}"
                                                     class="barcode-svg"
                                                     x-show="barcodeRendered['{{ identifier.id }}'] && !barcodeErrors['{{ identifier.id }}']"
                                                     style="max-width: 150px;
                                                            height: auto">
                                                </svg>
                                                <span x-show="!barcodeRendered['{{ identifier.id }}'] && !barcodeErrors['{{ identifier.id }}']"
                                                      class="text-gray-600">
                                                    <i class="fas fa-spinner fa-spin"></i>
                                                </span>
                                                <span x-show="barcodeErrors['{{ identifier.id }}']"
                                                      class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-700">
                                                    <i class="fas fa-info-circle mr-1"></i>Not Applicable
                                                </span>
                                            </div>
                                        {% else %}
                                            <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-700">
                                                <i class="fas fa-info-circle mr-1"></i>Not Applicable
                                            </span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endif %}
