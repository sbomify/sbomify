{% comment %}
StandardCard Component

Usage:
{% from 'core/components/standard_card.html.j2' import render_standard_card %}
{% call(slot) render_standard_card(title='My Card', variant='default') %}
    {% if slot == 'header_actions' %}
        <button class="px-4 py-2 bg-brand-primary text-white rounded hover:opacity-90 transition-opacity">Action</button>
    {% elif slot == 'info_notice' %}
        Some info notice text
    {% elif slot == 'content' %}
        Main content here
    {% elif slot == 'actions' %}
        Action buttons
    {% elif slot == 'footer' %}
        Footer content
    {% endif %}
{% endcall %}

Parameters:
- title: Card title (optional)
- collapsible: Enable collapse behavior (default: false)
- default_expanded: Initial expanded state (default: true)
- info_icon: Icon class for info notice (default: 'fas fa-info-circle')
- storage_key: Session storage key for collapse state
- variant: 'default' | 'stats' | 'plan' | 'modal' | 'settings' | 'dangerzone'
- size: 'small' | 'medium' | 'large'
- emphasis: Highlight the card (default: false)
- center_content: Center the content (default: false)
- no_padding: Remove body padding (default: false)
- shadow: 'none' | 'sm' | 'md' | 'lg'
{% endcomment %}
{% macro render_standard_card(
    title='',
    collapsible=false,
    default_expanded=true,
    info_icon='fas fa-info-circle',
    storage_key='',
    variant='default',
    size='medium',
    emphasis=false,
    center_content=false,
    no_padding=false,
    shadow='sm'
    ) %}
    {% set container_class = 'mt-3' if size == 'medium' else ('mt-2' if size == 'small' else 'mt-4') %}
    {% set card_classes = [] %}
    {% if variant == 'stats' %}
        {% set card_classes = card_classes + ['stats-card'] %}
    {% elif variant == 'plan' %}
        {% set card_classes = card_classes + ['plan-card'] %}
        {% if emphasis %}
            {% set card_classes = card_classes + ['plan-emphasis'] %}
        {% endif %}
    {% elif variant == 'modal' %}
        {% set card_classes = card_classes + ['modal-card'] %}
    {% elif variant == 'settings' %}
        {% set card_classes = card_classes + ['settings-card'] %}
    {% elif variant == 'dangerzone' %}
        {% set card_classes = card_classes + ['dangerzone-card'] %}
    {% endif %}
    {# Shadow classes are already Tailwind-compatible, keep as is #}
    {% if shadow == 'none' %}
        {% set card_classes = card_classes + ['shadow-none'] %}
    {% elif shadow == 'md' %}
        {% set card_classes = card_classes + ['shadow-md'] %}
    {% elif shadow == 'lg' %}
        {% set card_classes = card_classes + ['shadow-lg'] %}
    {% else %}
        {% set card_classes = card_classes + ['shadow-sm'] %}
    {% endif %}
    {% set header_classes = [] %}
    {% if collapsible %}
        {% set header_classes = header_classes + ['collapsible-header'] %}
    {% endif %}
    {% if emphasis and variant == 'plan' %}
        {% set header_classes = header_classes + ['bg-emphasis', 'text-emphasis', 'border-emphasis'] %}
    {% endif %}
    {% set body_classes = [] %}
    {% if center_content %}
        {% set body_classes = body_classes + ['text-center'] %}
    {% endif %}
    {# Padding classes are already Tailwind-compatible, keep as is #}
    {% if no_padding %}
        {% set body_classes = body_classes + ['p-0'] %}
    {% endif %}
    {% set footer_classes = [] %}
    {% if emphasis and variant == 'plan' %}
        {% set footer_classes = footer_classes + ['border-emphasis'] %}
    {% endif %}
    <div class="standard-card {{ container_class }}"
         {% if collapsible %} x-cloak x-data="standardCard({ storageKey: '{{ storage_key }}', defaultExpanded: {{ 'true' if default_expanded else 'false' }} })" {% endif %}>
        <div class="bg-white rounded-lg {{ card_classes | join(" ") }}"
             {% if collapsible %}:class="{ 'card-collapsed': !isExpanded }"{% endif %}>
            {% set header_actions_content = caller('header_actions') if caller else '' %}
            {% if title or header_actions_content.strip() %}
                <div class="card-header {{ header_classes | join(" ") }}">
                    <div class="header-content">
                        {% if title %}
                            <h4 class="card-title mb-0"
                                {% if collapsible %}style="cursor: pointer;" @click="toggleCollapse()" role="button" tabindex="0" @keydown.enter="toggleCollapse()" @keydown.space.prevent="toggleCollapse()" :aria-expanded="isExpanded" aria-controls="standard-card-body-{{ storage_key }}"{% endif %}>
                                {% if info_icon and variant == 'dangerzone' %}<i class="{{ info_icon }} me-2" aria-hidden="true"></i>{% endif %}
                                {{ title }}
                                {% if collapsible %}
                                    <i class="fas ms-2"
                                       :class="isExpanded ? 'fa-chevron-down' : 'fa-chevron-right'"
                                       aria-hidden="true"></i>
                                {% endif %}
                            </h4>
                        {% endif %}
                        {% if header_actions_content.strip() %}<div class="header-actions">{{ header_actions_content }}</div>{% endif %}
                    </div>
                </div>
            {% endif %}
            <div class="p-6 {{ body_classes | join(" ") }}"
                 {% if collapsible %}id="standard-card-body-{{ storage_key }}" x-show="isExpanded" x-collapse{% endif %}>
                {% set info_notice_content = caller('info_notice') if caller else '' %}
                {% if info_notice_content.strip() %}
                    <div class="augmentation-notice flex items-center mb-3">
                        <i class="{{ info_icon }} mr-2" style="color: var(--brand-primary);"></i>
                        <span class="text-gray-600">{{ info_notice_content }}</span>
                    </div>
                {% endif %}
                {{ caller("content") if caller else '' }}
                {% set actions_content = caller('actions') if caller else '' %}
                {% if actions_content.strip() %}<div class="card-actions">{{ actions_content }}</div>{% endif %}
            </div>
            {% set footer_content = caller('footer') if caller else '' %}
            {% if footer_content.strip() %}
                <div class="px-6 py-4 border-t bg-gray-50 {{ footer_classes | join(" ") }}">{{ footer_content }}</div>
            {% endif %}
        </div>
    </div>
{% endmacro %}
