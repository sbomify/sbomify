{% comment %}
Workspace Health Score Component
Displays workspace health score with circular progress indicator.

Parameters:
- health_score: Integer 0-100
- health_highlights: List of health highlights (strings)
- details_url: Optional URL to detailed health view
{% endcomment %}
<div class="tw-card h-full">
    <div class="px-6 py-4 border-b border-border">
        <h3 class="text-lg font-semibold text-text flex items-center gap-2 m-0">
            <i class="fas fa-heartbeat {% if health_score >= 80 %}text-success{% elif health_score >= 50 %}text-warning{% else %}text-danger{% endif %}"></i>
            Workspace Health
        </h3>
    </div>
    <div class="p-6">
        <div class="flex flex-col items-center mb-6">
            {# Circular Progress Indicator using SVG #}
            <div class="relative w-32 h-32"
                 x-data="{ score: {{ health_score|default:0 }} }">
                <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 100 100">
                    {# Background circle #}
                    <circle cx="50" cy="50" r="45" stroke="currentColor" stroke-width="8" fill="none" class="text-border" />
                    {# Progress circle #}
                    <circle cx="50" cy="50" r="45" stroke="currentColor" stroke-width="8" fill="none" class="
                    {% if health_score >= 80 %}
                        text-success
                    {% elif health_score >= 50 %}
                        text-warning
                    {% else %}
                        text-danger
                    {% endif %}
                    " stroke-linecap="round" stroke-dasharray="283" :stroke-dashoffset="283 - (283 * score / 100)" style="transition: stroke-dashoffset 0.5s ease-in-out;" />
                </svg>
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                    <span class="text-3xl font-bold text-text">{{ health_score|default:0 }}%</span>
                    <span class="text-xs {% if health_score >= 80 %}text-success{% elif health_score >= 50 %}text-warning{% else %}text-danger{% endif %} font-medium">
                        {% if health_score >= 80 %}
                            Excellent
                        {% elif health_score >= 50 %}
                            Good
                        {% else %}
                            Needs Attention
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
        {# Key Highlights #}
        {% if health_highlights %}
            <div class="space-y-2">
                <h4 class="text-sm font-medium text-text-muted uppercase tracking-wide mb-3">Key Highlights</h4>
                <ul class="space-y-2">
                    {% for highlight in health_highlights %}
                        <li class="flex items-start gap-2 text-sm">
                            <i class="fas fa-check-circle text-success mt-0.5 flex-shrink-0"></i>
                            <span class="text-text">{{ highlight }}</span>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% else %}
            <div class="space-y-2">
                <h4 class="text-sm font-medium text-text-muted uppercase tracking-wide mb-3">Recommendations</h4>
                <ul class="space-y-2">
                    {% if products_count == 0 %}
                        <li class="flex items-start gap-2 text-sm">
                            <i class="fas fa-info-circle text-warning mt-0.5 flex-shrink-0"></i>
                            <span class="text-text">Create your first product</span>
                        </li>
                    {% endif %}
                    {% if sboms_count == 0 %}
                        <li class="flex items-start gap-2 text-sm">
                            <i class="fas fa-info-circle text-warning mt-0.5 flex-shrink-0"></i>
                            <span class="text-text">Upload an SBOM</span>
                        </li>
                    {% endif %}
                    {% if scans_count == 0 %}
                        <li class="flex items-start gap-2 text-sm">
                            <i class="fas fa-info-circle text-warning mt-0.5 flex-shrink-0"></i>
                            <span class="text-text">Run a vulnerability scan</span>
                        </li>
                    {% endif %}
                    {% if products_count > 0 and sboms_count > 0 and scans_count > 0 %}
                        <li class="flex items-start gap-2 text-sm">
                            <i class="fas fa-check-circle text-success mt-0.5 flex-shrink-0"></i>
                            <span class="text-text">Your workspace is well configured</span>
                        </li>
                    {% endif %}
                </ul>
            </div>
        {% endif %}
        {% if details_url %}
            <div class="mt-4 pt-4 border-t border-border">
                <a href="{{ details_url }}"
                   class="text-sm text-primary hover:text-primary-dark flex items-center gap-1">
                    View detailed report
                    <i class="fas fa-arrow-right text-xs"></i>
                </a>
            </div>
        {% endif %}
    </div>
</div>
