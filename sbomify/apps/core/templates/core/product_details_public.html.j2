{% extends "core/public_base.htmx.j2" %}
{% load breadcrumb_tags %}
{% load django_vite %}
{% load static %}
{% load public_url_tags %}
{% load humanize %}
{% block title %}{{ product.name }}{% endblock %}
{% block extra_css %}
    <link rel="stylesheet"
          href="{% static 'css/components/public-compliance-badge.css' %}">
    <style>
  .meta-chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 999px;
    background: rgba(var(--brand-color-rgb), 0.05);
    border: 1px solid rgba(var(--brand-color-rgb), 0.1);
    color: var(--brand-color);
    font-weight: 600;
  }
  .meta-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 8px;
  }
  .title-icon {
    color: var(--brand-color);
  }
    </style>
{% endblock %}
{% block meta_description %}
    {{ product.name }} - Software Bill of Materials (SBOM) for this product. View projects, components, and download SBOMs.
{% endblock %}
{% block breadcrumb %}
    {% breadcrumb product 'product' %}
{% endblock %}
{% block content %}
    <div class="public-page-layout">
        <div class="content-wrapper">
            <div class="content-container">
                <div class="public-page-header">
                    <div class="page-header-content">
                        {% if workspace_public_url %}
                            <div class="mb-2">
                                <a class="btn btn-outline-secondary btn-sm"
                                   href="{{ workspace_public_url }}">
                                    <i class="fas fa-arrow-left me-1"></i> Back to Trust Center
                                </a>
                            </div>
                        {% endif %}
                        <p class="eyebrow text-muted mb-1">Public product</p>
                        <h1 class="page-title">
                            <i class="fas fa-box title-icon"></i>
                            {{ product.name }}
                        </h1>
                        <p class="text-muted mb-1">{{ product.description|default:"No description provided." }}</p>
                        <div class="meta-row">
                            {% if public_projects %}
                                <span class="meta-chip">
                                    <i class="fas fa-diagram-project"></i>
                                    {{ public_projects|length|apnumber }} project{{ public_projects|length|pluralize }}
                                </span>
                            {% endif %}
                            <span class="meta-chip">
                                <i class="fas fa-globe"></i>
                                Public
                            </span>
                            {% for assessment in passing_assessments %}
                                <span class="meta-chip meta-chip--compliance"
                                      title="{{ assessment.display_name }}: All checks passed">
                                    <i class="fas fa-check-circle"></i>
                                    {{ assessment.display_name }}
                                </span>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="public-main-content">
                    <div class="content-section">
                        <div class="product-content">
                            {# Product Identifiers - server-rendered, hidden when empty #}
                            {% include 'core/components/public_product_identifiers.html.j2' %}
                            {# Product Links - server-rendered, hidden when empty #}
                            {% include 'core/components/public_product_links.html.j2' %}
                            {# Product Projects - server-rendered, hidden when empty #}
                            {% include 'core/components/public_product_projects.html.j2' with projects=public_projects %}
                            {# Product Releases - server-rendered, hidden when empty #}
                            {% include 'core/components/public_releases_list.html.j2' %}
                            {% if has_downloadable_content %}
                                <div class="download-section">
                                    <div class="standard-card mt-3">
                                        <div class="card shadow-sm">
                                            <div class="card-header">
                                                <div class="header-content">
                                                    <h4 class="card-title mb-0">Download Latest Release</h4>
                                                </div>
                                            </div>
                                            <div class="card-body text-center">
                                                <p class="text-muted mb-3">
                                                    Download SBOM from the latest release containing the most current artifacts for this product
                                                </p>
                                                <a href="{% url 'core:sbom_download_product' product.id %}"
                                                   class="btn btn-primary">
                                                    <i class="fas fa-download me-2"></i>Download Latest Release
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    {% vite_asset 'sbomify/apps/core/js/main.ts' %}
    {% vite_asset 'sbomify/apps/sboms/js/main.ts' %}
{% endblock %}
