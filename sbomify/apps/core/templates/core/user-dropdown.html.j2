<div class="relative" x-data="dropdown" @click.away="close()">
    <button class="btn-user-avatar"
            type="button"
            @click="toggle()"
            :aria-expanded="isOpen"
            aria-haspopup="true"
            aria-label="User menu">
        {% if request.session.user_photo %}
            <img src="{{ request.session.user_photo }}"
                 class="user-avatar-img"
                 alt="{{ request.user.get_full_name|default:request.user.username }}"
                 width="32"
                 height="32" />
        {% else %}
            {% load teams %}
            <div class="user-avatar-placeholder">{{ request.user|user_initials }}</div>
        {% endif %}
        <i class="fas fa-chevron-down user-avatar-chevron" aria-hidden="true"></i>
    </button>
    <ul class="absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg z-dropdown"
        x-show="isOpen"
        @keydown.escape.window="close()"
        role="menu">
        <li role="presentation">
            <h6 class="px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider"
                role="heading"
                aria-level="2">{{ request.user.get_full_name|default:request.user.username }}</h6>
        </li>
        <li role="presentation">
            <a class="block px-4 py-2 text-sm text-black hover:bg-gray-100"
               href="{% url 'core:settings' %}"
               role="menuitem"
               title="Account settings"
               @click="close()">
                <span class="flex items-center justify-between">
                    <span class="flex items-center">
                        <i class="mr-2 fas fa-cog"></i>
                        Settings
                    </span>
                    {% if pending_invitations_count > 0 %}
                        <span class="inline-flex items-center px-2 py-1 text-xs font-bold leading-none text-white rounded-full bg-danger-500 ml-2">{{ pending_invitations_count }}</span>
                    {% endif %}
                </span>
            </a>
        </li>
        <li role="presentation">
            <hr class="my-1 border-gray-200">
        </li>
        <li role="presentation">
            <a class="block px-4 py-2 text-sm text-black hover:bg-gray-100"
               href="{% url 'core:logout' %}"
               role="menuitem"
               @click="close()">
                <i class="mr-2 fas fa-sign-out-alt"></i>
                Log out
            </a>
        </li>
    </ul>
</div>
