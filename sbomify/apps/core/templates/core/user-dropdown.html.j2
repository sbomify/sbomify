<li class="nav-item dropdown">
    <button class="nav-icon dropdown-toggle btn btn-link border-0 bg-transparent d-inline-block d-sm-none position-relative"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            aria-haspopup="true"
            aria-label="User menu (mobile)">
        <i class="align-middle fas fa-cog"></i>
        {% if pending_invitations_count > 0 %}
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger navbar-badge-custom">
                {{ pending_invitations_count }}
                <span class="visually-hidden">pending invitations</span>
            </span>
        {% endif %}
    </button>
    <button class="nav-link dropdown-toggle btn btn-link border-0 bg-transparent d-none d-sm-inline-flex align-items-center position-relative"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            aria-haspopup="true"
            aria-label="User menu">
        {% if request.session.user_photo %}
            <img src="{{ request.session.user_photo }}"
                 class="avatar img-fluid rounded-circle me-2"
                 alt="{{ request.user.get_full_name|default:request.user.username }}"
                 width="32"
                 height="32" />
        {% else %}
            <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center user-avatar-placeholder me-2">
                <i class="fas fa-user text-white" aria-hidden="true"></i>
            </div>
        {% endif %}
        <span class="text-dark">
            {% if request.user.first_name %}
                {{ request.user.first_name }} {{ request.user.last_name }}
            {% else %}
                {{ request.user.username }}
            {% endif %}
        </span>
        {% if pending_invitations_count > 0 %}
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger navbar-badge-custom">
                {{ pending_invitations_count }}
                <span class="visually-hidden">pending invitations</span>
            </span>
        {% endif %}
    </button>
    <ul class="dropdown-menu dropdown-menu-end shadow-sm" role="menu">
        <li role="presentation">
            <h6 class="dropdown-header" role="heading" aria-level="2">
                {{ request.user.get_full_name|default:request.user.username }}
            </h6>
        </li>
        <li role="presentation">
            <a class="dropdown-item"
               href="{% url 'core:settings' %}"
               role="menuitem">
                <span class="d-flex align-items-center justify-content-between">
                    <span class="d-flex align-items-center">
                        <i class="align-middle me-2 fas fa-cog"></i>
                        Settings
                    </span>
                    {% if pending_invitations_count > 0 %}
                        <span class="badge bg-danger ms-2 rounded-pill">{{ pending_invitations_count }}</span>
                    {% endif %}
                </span>
            </a>
        </li>
        <li role="presentation">
            <hr class="dropdown-divider">
        </li>
        <li role="presentation">
            <a class="dropdown-item text-danger"
               href="{% url 'core:logout' %}"
               role="menuitem">
                <i class="align-middle me-2 fas fa-sign-out-alt"></i>
                Log out
            </a>
        </li>
    </ul>
</li>
