{% load static %}
{% load humanize %}
<!-- Access Requests Section -->
<div class="standard-card mb-4" x-cloak x-data="accessRequestQueue()">
    <div class="bg-white rounded-lg settings-card shadow-md">
        <div class="px-6 py-4 border-b flex justify-between items-center">
            <h4 class="text-lg font-semibold mb-0">Access Requests</h4>
            <button type="button"
                    class="px-3 py-1.5 bg-brand-primary text-white rounded text-sm hover:opacity-90 transition-opacity"
                    @click="$dispatch('open-modal', { id: 'inviteUserModal' })">
                <i class="fas fa-user-plus mr-1"></i>Invite
            </button>
        </div>
        <div class="p-6">
            <p class="text-gray-600 mb-4">
                Manage access requests for gated components. Approve or reject requests from users who want to access your gated documents and SBOMs.
            </p>
            <div class="mb-4">
                <h5 class="mb-3">Pending Requests</h5>
                {% if pending_requests %}
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-2">User</th>
                                    <th class="text-left py-2">Email</th>
                                    <th class="text-left py-2">Requested</th>
                                    <th class="text-left py-2">NDA Signed</th>
                                    <th class="text-left py-2">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for req in pending_requests %}
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="py-2">
                                            {% if req.user.first_name or req.user.last_name %}
                                                {{ req.user.first_name }} {{ req.user.last_name }}
                                            {% else %}
                                                {{ req.user.username }}
                                            {% endif %}
                                        </td>
                                        <td class="py-2">{{ req.user.email }}</td>
                                        <td class="py-2">{{ req.requested_at|naturaltime }}</td>
                                        <td class="py-2">
                                            {% if req.nda_signature %}
                                                {% if req.has_current_nda_signature %}
                                                    {% if req.nda_signature.is_document_modified %}
                                                        <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-danger-500 text-white"
                                                              title="NDA document has been modified after signing">
                                                            Modified
                                                        </span>
                                                    {% else %}
                                                        <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-success-500 text-white">Yes</span>
                                                    {% endif %}
                                                {% else %}
                                                    <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-warning-500 text-white"
                                                          title="NDA version has been updated. User needs to sign the new version.">
                                                        Invalid
                                                    </span>
                                                {% endif %}
                                            {% else %}
                                                <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-warning-500 text-white">No</span>
                                            {% endif %}
                                        </td>
                                        <td class="py-2">
                                            <div class="flex gap-2 items-center">
                                                <button type="button"
                                                        class="btn-icon btn-icon-edit"
                                                        @click="$dispatch('open-modal', { id: 'accessRequestInfoModal' })"
                                                        title="View Details"
                                                        data-request-id="{{ req.id }}"
                                                        data-user-name="{% if req.user.first_name or req.user.last_name %}{{ req.user.first_name }} {{ req.user.last_name }}{% else %}{{ req.user.username }}{% endif %}"
                                                        data-user-email="{{ req.user.email }}"
                                                        data-status="{{ req.status }}"
                                                        data-requested-at="{{ req.requested_at|date:'F d, Y g:i A' }}"
                                                        data-decided-at="{% if req.decided_at %}{{ req.decided_at|date:'F d, Y g:i A' }}{% endif %}"
                                                        data-decided-by="{% if req.decided_by %}{{ req.decided_by.email }}{% endif %}"
                                                        data-revoked-at="{% if req.revoked_at %}{{ req.revoked_at|date:'F d, Y g:i A' }}{% endif %}"
                                                        data-revoked-by="{% if req.revoked_by %}{{ req.revoked_by.email }}{% endif %}"
                                                        data-notes="{{ req.notes|default:'' }}"
                                                        data-nda-signed="{% if req.nda_signature %}true{% else %}false{% endif %}"
                                                        data-nda-signed-name="{% if req.nda_signature %}{{ req.nda_signature.signed_name }}{% endif %}"
                                                        data-nda-signed-at="{% if req.nda_signature %}{{ req.nda_signature.signed_at|date:'F d, Y g:i A' }}{% endif %}"
                                                        data-nda-ip="{% if req.nda_signature %}{{ req.nda_signature.ip_address|default:'' }}{% endif %}"
                                                        data-nda-modified="{% if req.nda_signature and req.nda_signature.is_document_modified %}true{% else %}false{% endif %}"
                                                        data-nda-current="{% if req.has_current_nda_signature %}true{% else %}false{% endif %}"
                                                        data-nda-url="{% if req.nda_signature %}{% url 'documents:document_download' req.nda_signature.nda_document.id %}?view=inline{% endif %}">
                                                    <i class="fas fa-info-circle"></i>
                                                </button>
                                                <form method="post"
                                                      action="{% url 'documents:access_request_queue' team.key %}"
                                                      class="inline"
                                                      id="access-request-form-{{ req.id }}">
                                                    {% csrf_token %}
                                                    <input type="hidden" name="request_id" value="{{ req.id }}">
                                                    <input type="hidden" name="active_tab" value="trust-center">
                                                    <div class="flex gap-2">
                                                        <button type="submit"
                                                                name="action"
                                                                value="approve"
                                                                class="btn-icon btn-icon-approve"
                                                                title="Approve Access"
                                                                data-bs-toggle="tooltip"
                                                                data-bs-placement="top">
                                                            <i class="fas fa-check"></i>
                                                        </button>
                                                        <button type="button"
                                                                name="action"
                                                                value="reject"
                                                                class="btn-icon btn-icon-delete reject-btn"
                                                                title="Reject Access"
                                                                data-bs-toggle="tooltip"
                                                                data-bs-placement="top"
                                                                data-request-id="{{ req.id }}"
                                                                data-user-email="{{ req.user.email }}">
                                                            <i class="fas fa-times"></i>
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-600 mb-0">No pending access requests.</p>
                {% endif %}
            </div>
            <div class="mb-4">
                <h5 class="mb-3">Pending Invitations</h5>
                {% if pending_invitations %}
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-2">Email</th>
                                    <th class="text-left py-2">Invited By</th>
                                    <th class="text-left py-2">Invited</th>
                                    <th class="text-left py-2">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in pending_invitations %}
                                    {% with invitation=item.invitation inviter_email=item.inviter_email %}
                                        <tr class="border-b hover:bg-gray-50">
                                            <td class="py-2">{{ invitation.email }}</td>
                                            <td class="py-2">
                                                {% if inviter_email %}
                                                    {{ inviter_email }}
                                                {% else %}
                                                    <span class="text-gray-600">—</span>
                                                {% endif %}
                                            </td>
                                            <td class="py-2">{{ invitation.created_at|naturaltime }}</td>
                                            <td class="py-2">
                                                <button type="button"
                                                        class="btn-icon btn-icon-delete"
                                                        @click="$dispatch('open-modal', { id: 'cancelInvitationModal' })"
                                                        title="Cancel Invitation"
                                                        data-invitation-id="{{ invitation.id }}"
                                                        data-invitation-email="{{ invitation.email }}">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    {% endwith %}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-600 mb-0">No pending invitations.</p>
                {% endif %}
            </div>
            <div>
                <h5 class="mb-3">Approved Requests</h5>
                {% if approved_requests %}
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-2">User</th>
                                    <th class="text-left py-2">Email</th>
                                    <th class="text-left py-2">Approved By</th>
                                    <th class="text-left py-2">NDA Status</th>
                                    <th class="text-left py-2">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for req in approved_requests %}
                                    <tr class="border-b hover:bg-gray-50">
                                        <td class="py-2">
                                            {% if req.user.first_name or req.user.last_name %}
                                                {{ req.user.first_name }} {{ req.user.last_name }}
                                            {% else %}
                                                {{ req.user.username }}
                                            {% endif %}
                                        </td>
                                        <td class="py-2">{{ req.user.email }}</td>
                                        <td class="py-2">
                                            {% if req.decided_by %}
                                                {{ req.decided_by.email }}
                                            {% else %}
                                                <span class="text-gray-600">—</span>
                                            {% endif %}
                                        </td>
                                        <td class="py-2">
                                            {% if req.nda_signature %}
                                                {% if req.has_current_nda_signature %}
                                                    {% if req.nda_signature.is_document_modified %}
                                                        <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-danger-500 text-white"
                                                              title="NDA document has been modified after signing">
                                                            Modified
                                                        </span>
                                                    {% else %}
                                                        <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-success-500 text-white">Valid</span>
                                                    {% endif %}
                                                {% else %}
                                                    <span class="inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-warning-500 text-white"
                                                          title="NDA version has been updated. User needs to sign the new version.">
                                                        Invalid
                                                    </span>
                                                {% endif %}
                                            {% else %}
                                                <span class="text-gray-600">—</span>
                                            {% endif %}
                                        </td>
                                        <td class="py-2">
                                            <div class="flex gap-2 items-center">
                                                <button type="button"
                                                        class="btn-icon btn-icon-edit"
                                                        @click="$dispatch('open-modal', { id: 'accessRequestInfoModal' })"
                                                        title="View Details"
                                                        data-request-id="{{ req.id }}"
                                                        data-user-name="{% if req.user.first_name or req.user.last_name %}{{ req.user.first_name }} {{ req.user.last_name }}{% else %}{{ req.user.username }}{% endif %}"
                                                        data-user-email="{{ req.user.email }}"
                                                        data-status="{{ req.status }}"
                                                        data-requested-at="{{ req.requested_at|date:'F d, Y g:i A' }}"
                                                        data-decided-at="{% if req.decided_at %}{{ req.decided_at|date:'F d, Y g:i A' }}{% endif %}"
                                                        data-decided-by="{% if req.decided_by %}{{ req.decided_by.email }}{% endif %}"
                                                        data-revoked-at="{% if req.revoked_at %}{{ req.revoked_at|date:'F d, Y g:i A' }}{% endif %}"
                                                        data-revoked-by="{% if req.revoked_by %}{{ req.revoked_by.email }}{% endif %}"
                                                        data-notes="{{ req.notes|default:'' }}"
                                                        data-nda-signed="{% if req.nda_signature %}true{% else %}false{% endif %}"
                                                        data-nda-signed-name="{% if req.nda_signature %}{{ req.nda_signature.signed_name }}{% endif %}"
                                                        data-nda-signed-at="{% if req.nda_signature %}{{ req.nda_signature.signed_at|date:'F d, Y g:i A' }}{% endif %}"
                                                        data-nda-ip="{% if req.nda_signature %}{{ req.nda_signature.ip_address|default:'' }}{% endif %}"
                                                        data-nda-modified="{% if req.nda_signature and req.nda_signature.is_document_modified %}true{% else %}false{% endif %}"
                                                        data-nda-current="{% if req.has_current_nda_signature %}true{% else %}false{% endif %}"
                                                        data-nda-url="{% if req.nda_signature %}{% url 'documents:document_download' req.nda_signature.nda_document.id %}?view=inline{% endif %}">
                                                    <i class="fas fa-info-circle"></i>
                                                </button>
                                                <form method="post"
                                                      action="{% url 'documents:access_request_queue' team.key %}"
                                                      class="inline">
                                                    {% csrf_token %}
                                                    <input type="hidden" name="request_id" value="{{ req.id }}">
                                                    <input type="hidden" name="active_tab" value="trust-center">
                                                    <button type="button"
                                                            class="btn-icon btn-icon-delete"
                                                            @click="$dispatch('open-modal', { id: 'revokeAccessModal' })"
                                                            title="Revoke Access"
                                                            data-request-id="{{ req.id }}"
                                                            data-user-email="{{ req.user.email }}">
                                                        <i class="fas fa-ban"></i>
                                                    </button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-600 mb-0">No approved access requests.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<!-- Invite User Modal -->
<div class="fixed inset-0 z-modal overflow-y-auto"
     id="inviteUserModal"
     tabindex="-1"
     aria-labelledby="inviteUserModalLabel"
     x-data="{ inviteModalOpen: false }"
     x-show="inviteModalOpen"
     x-trap.inert.noscroll="inviteModalOpen"
     @keydown.escape.window="inviteModalOpen = false"
     @open-modal.window="if ($event.detail.id === 'inviteUserModal') inviteModalOpen = true"
     :aria-hidden="!inviteModalOpen"
     style="display: none">
    <div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity"
         x-show="inviteModalOpen"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="inviteModalOpen = false"></div>
    <div class="flex min-h-full items-center justify-center p-4">
        <div class="relative mx-auto my-8 w-full max-w-md transform overflow-hidden rounded-lg bg-white shadow-xl transition-all"
             x-show="inviteModalOpen"
             x-transition:enter="ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
             x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave="ease-in duration-200"
             x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave-end="opacity-0 translate-y-4 sm:scale-95"
             @click.stop>
            <div class="px-6 py-4 border-b flex justify-between items-center">
                <h5 class="text-lg font-semibold" id="inviteUserModalLabel">Invite User</h5>
                <button type="button"
                        class="text-gray-400 hover:text-gray-600 focus:outline-none"
                        @click="inviteModalOpen = false"
                        aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form method="post"
                  action="{% url 'documents:access_request_queue' team.key %}"
                  hx-post="{% url 'documents:access_request_queue' team.key %}"
                  hx-target="#access-requests-wrapper"
                  hx-swap="innerHTML"
                  hx-trigger="submit">
                {% csrf_token %}
                <input type="hidden" name="action" value="invite">
                <input type="hidden" name="active_tab" value="trust-center">
                <div class="px-6 py-4">
                    <div class="bg-info-50 border border-info-200 text-info-800 px-4 py-3 rounded mb-4">
                        <i class="fas fa-info-circle mr-2"></i>
                        <strong>What does this invitation do?</strong>
                        <p class="mb-0 mt-2">
                            The user will receive an email invitation to join this workspace.
                            If they don't have an account, they'll be prompted to create one.
                            After signing in and completing any required NDA, they will automatically join with access to gated components.
                        </p>
                    </div>
                    <div class="mb-4">
                        <label for="invite_email"
                               class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                        <input type="email"
                               class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-brand-primary focus:border-transparent"
                               id="invite_email"
                               name="email"
                               placeholder="user@example.com"
                               required>
                        <div class="text-sm text-gray-600 mt-1">The user will receive an invitation email to join this workspace.</div>
                    </div>
                </div>
                <div class="px-6 py-4 border-t flex justify-end gap-2">
                    <button type="button"
                            class="px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50 transition-colors"
                            @click="inviteModalOpen = false">Cancel</button>
                    <button type="submit"
                            class="px-4 py-2 bg-brand-primary text-white rounded hover:opacity-90 transition-opacity">
                        <i class="fas fa-paper-plane mr-1"></i>Send Invitation
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Cancel Invitation Modal -->
<div class="fixed inset-0 z-modal overflow-y-auto"
     id="cancelInvitationModal"
     tabindex="-1"
     aria-labelledby="cancelInvitationModalLabel"
     x-data="{ cancelModalOpen: false }"
     x-show="cancelModalOpen"
     x-trap.inert.noscroll="cancelModalOpen"
     @keydown.escape.window="cancelModalOpen = false"
     @open-modal.window="if ($event.detail.id === 'cancelInvitationModal') cancelModalOpen = true"
     :aria-hidden="!cancelModalOpen"
     style="display: none">
    <div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity"
         x-show="cancelModalOpen"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="cancelModalOpen = false"></div>
    <div class="flex min-h-full items-center justify-center p-4">
        <div class="relative mx-auto my-8 w-full max-w-md transform overflow-hidden rounded-lg bg-white shadow-xl transition-all delete-modal"
             x-show="cancelModalOpen"
             x-transition:enter="ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
             x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave="ease-in duration-200"
             x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave-end="opacity-0 translate-y-4 sm:scale-95"
             @click.stop>
            <div class="delete-modal-header">
                <div class="delete-modal-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 class="delete-modal-title" id="cancelInvitationModalLabel">Cancel Invitation</h3>
                <button type="button"
                        class="delete-modal-close"
                        @click="cancelModalOpen = false"
                        aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="delete-modal-body">
                <p class="delete-modal-message">
                    Are you sure you want to cancel the invitation sent to <span class="delete-modal-name" id="cancelInvitationModalDisplayEmail"></span>?
                </p>
                <p class="delete-modal-warning">This will cancel the invitation and the user will no longer be able to accept it.</p>
            </div>
            <div class="delete-modal-footer">
                <button type="button"
                        class="delete-modal-button delete-modal-button--secondary"
                        @click="cancelModalOpen = false">Cancel</button>
                <form id="cancelInvitationModalForm"
                      method="post"
                      action="{% url 'documents:access_request_queue' team.key %}"
                      class="inline">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="cancel_invitation">
                    <input type="hidden"
                           name="invitation_id"
                           id="cancelInvitationModalInvitationId"
                           value="">
                    <input type="hidden" name="active_tab" value="trust-center">
                    <button type="submit" class="delete-modal-button delete-modal-button--danger">
                        <i class="fas fa-times mr-2"></i>Cancel Invitation
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Access Request Info Modal -->
<div class="fixed inset-0 z-modal overflow-y-auto"
     id="accessRequestInfoModal"
     tabindex="-1"
     aria-labelledby="accessRequestInfoModalLabel"
     role="dialog"
     aria-modal="true"
     x-data="{ infoModalOpen: false }"
     x-show="infoModalOpen"
     x-trap.inert.noscroll="infoModalOpen"
     @keydown.escape.window="infoModalOpen = false"
     @open-modal.window="if ($event.detail.id === 'accessRequestInfoModal') infoModalOpen = true"
     :aria-hidden="!infoModalOpen"
     style="display: none">
    <div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity"
         x-show="infoModalOpen"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="infoModalOpen = false"></div>
    <div class="flex min-h-full items-center justify-center p-4">
        <div class="relative mx-auto my-8 w-full max-w-2xl transform overflow-hidden rounded-lg bg-white shadow-xl transition-all delete-modal"
             x-show="infoModalOpen"
             x-transition:enter="ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
             x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave="ease-in duration-200"
             x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave-end="opacity-0 translate-y-4 sm:scale-95"
             @click.stop>
            <div class="delete-modal-header">
                <h3 class="delete-modal-title" id="accessRequestInfoModalLabel">Audit Trail</h3>
                <button type="button"
                        class="delete-modal-close"
                        @click="infoModalOpen = false"
                        aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="delete-modal-body" id="accessRequestInfoModalBody">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">User Name</label>
                            <div class="font-medium text-gray-900" id="info-user-name">—</div>
                        </div>
                    </div>
                    <div>
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Email</label>
                            <div class="font-medium text-gray-900" id="info-user-email">—</div>
                        </div>
                    </div>
                    <div>
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Request Status</label>
                            <div id="info-status">—</div>
                        </div>
                    </div>
                    <div>
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Requested At</label>
                            <div class="font-medium text-gray-900" id="info-requested-at">—</div>
                        </div>
                    </div>
                    <div id="info-decided-section" style="display: none;">
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Decided At</label>
                            <div class="font-medium text-gray-900" id="info-decided-at">—</div>
                        </div>
                    </div>
                    <div id="info-decided-by-section" style="display: none;">
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Decided By</label>
                            <div class="font-medium text-gray-900" id="info-decided-by">—</div>
                        </div>
                    </div>
                    <div id="info-revoked-section" style="display: none;">
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Revoked At</label>
                            <div class="font-medium text-gray-900" id="info-revoked-at">—</div>
                        </div>
                    </div>
                    <div id="info-revoked-by-section" style="display: none;">
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Revoked By</label>
                            <div class="font-medium text-gray-900" id="info-revoked-by">—</div>
                        </div>
                    </div>
                    <div class="col-span-2" id="info-nda-section" style="display: none;">
                        <hr class="my-4 border-gray-300">
                        <h6 class="mb-4 font-semibold text-gray-900">NDA Signature Information</h6>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <div class="mb-4">
                                    <label class="block text-xs text-gray-600 mb-1 font-medium">Signed Name</label>
                                    <div class="font-medium text-gray-900" id="info-nda-signed-name">—</div>
                                </div>
                            </div>
                            <div>
                                <div class="mb-4">
                                    <label class="block text-xs text-gray-600 mb-1 font-medium">Signed At</label>
                                    <div class="font-medium text-gray-900" id="info-nda-signed-at">—</div>
                                </div>
                            </div>
                            <div>
                                <div class="mb-4">
                                    <label class="block text-xs text-gray-600 mb-1 font-medium">IP Address</label>
                                    <div class="font-medium text-gray-900" id="info-nda-ip">—</div>
                                </div>
                            </div>
                            <div>
                                <div class="mb-4">
                                    <label class="block text-xs text-gray-600 mb-1 font-medium">NDA Status</label>
                                    <div id="info-nda-modified">—</div>
                                </div>
                            </div>
                            <div class="col-span-2">
                                <div class="mb-4">
                                    <label class="block text-xs text-gray-600 mb-1 font-medium">NDA Document</label>
                                    <div id="info-nda-url">—</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-span-2" id="info-notes-section" style="display: none;">
                        <hr class="my-4 border-gray-300">
                        <div class="mb-4">
                            <label class="block text-xs text-gray-600 mb-1 font-medium">Notes</label>
                            <div class="font-medium text-gray-900"
                                 style="white-space: pre-wrap"
                                 id="info-notes">—</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="delete-modal-footer">
                <button type="button"
                        class="delete-modal-button delete-modal-button--secondary"
                        @click="infoModalOpen = false">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Revoke Access Modal -->
{% load static %}
<link rel="stylesheet"
      href="{% static 'css/components/delete-modal.css' %}">
<div class="fixed inset-0 z-modal overflow-y-auto"
     id="revokeAccessModal"
     tabindex="-1"
     aria-labelledby="revokeAccessModalLabel"
     x-data="{ revokeModalOpen: false }"
     x-show="revokeModalOpen"
     x-trap.inert.noscroll="revokeModalOpen"
     @keydown.escape.window="revokeModalOpen = false"
     @open-modal.window="if ($event.detail.id === 'revokeAccessModal') revokeModalOpen = true"
     :aria-hidden="!revokeModalOpen"
     style="display: none">
    <div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity"
         x-show="revokeModalOpen"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="revokeModalOpen = false"></div>
    <div class="flex min-h-full items-center justify-center p-4">
        <div class="relative mx-auto my-8 w-full max-w-md transform overflow-hidden rounded-lg bg-white shadow-xl transition-all delete-modal"
             x-show="revokeModalOpen"
             x-transition:enter="ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
             x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave="ease-in duration-200"
             x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave-end="opacity-0 translate-y-4 sm:scale-95"
             @click.stop>
            <div class="delete-modal-header">
                <div class="delete-modal-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 class="delete-modal-title" id="revokeAccessModalLabel">Revoke Access</h3>
                <button type="button"
                        class="delete-modal-close"
                        @click="revokeModalOpen = false"
                        aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="delete-modal-body">
                <p class="delete-modal-message">
                    Are you sure you want to revoke access for <span class="delete-modal-name" id="revokeAccessModalDisplayName"></span>?
                </p>
                <p class="delete-modal-warning">
                    This will remove their guest membership and they will no longer have access to gated components.
                </p>
            </div>
            <div class="delete-modal-footer">
                <button type="button"
                        class="delete-modal-button delete-modal-button--secondary"
                        @click="revokeModalOpen = false">Cancel</button>
                <form id="revokeAccessModalForm"
                      method="post"
                      action="{% url 'documents:access_request_queue' team.key %}"
                      class="inline">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="revoke">
                    <input type="hidden"
                           name="request_id"
                           id="revokeAccessModalRequestId"
                           value="">
                    <input type="hidden" name="active_tab" value="trust-center">
                    <button type="submit" class="delete-modal-button delete-modal-button--danger">
                        <i class="fas fa-ban mr-2"></i>Revoke Access
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
