<div x-data="{ open: false }"
     @open-edit-document-modal.window="open = true">
    <template x-teleport="body">
        <div x-show="open"
             x-cloak
             class="fixed inset-0 z-[100]"
             id="edit-document-modal"
             role="dialog"
             aria-modal="true"
             aria-labelledby="editDocumentModalLabel">
            {# Backdrop #}
            <div x-show="open"
                 x-transition:enter="transition ease-out duration-200"
                 x-transition:enter-start="opacity-0"
                 x-transition:enter-end="opacity-100"
                 x-transition:leave="transition ease-in duration-150"
                 x-transition:leave-start="opacity-100"
                 x-transition:leave-end="opacity-0"
                 class="tw-modal-overlay"
                 @click="open = false"></div>
            {# Modal Content #}
            <div class="tw-modal"
                 x-show="open"
                 x-transition:enter="transition ease-out duration-200"
                 x-transition:enter-start="opacity-0 scale-95"
                 x-transition:enter-end="opacity-100 scale-100"
                 x-transition:leave="transition ease-in duration-150"
                 x-transition:leave-start="opacity-100 scale-100"
                 x-transition:leave-end="opacity-0 scale-95"
                 @click.stop
                 x-trap.noscroll="open"
                 @keydown.escape.window="if(open) open = false">
                <div class="tw-modal-content">
                    <div class="tw-modal-header">
                        <h4 class="tw-modal-title" id="editDocumentModalLabel">Edit Document</h4>
                        <button type="button"
                                @click="open = false"
                                class="tw-modal-close"
                                aria-label="Close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form hx-post="{% url 'documents:documents_table' component_id %}"
                          hx-disabled-elt="find button[type='submit']"
                          hx-swap="none"
                          @htmx:after-request="if($event.detail.successful) open = false">
                        {% csrf_token %}
                        <input type="hidden" name="_method" value="PATCH">
                        <input type="hidden" name="document_id" x-model="editForm.document_id">
                        <div class="tw-modal-body">
                            <div class="mb-4">
                                <label for="edit-document-name" class="tw-form-label">
                                    Name <span class="text-danger">*</span>
                                </label>
                                <input type="text"
                                       class="tw-form-input"
                                       id="edit-document-name"
                                       name="name"
                                       x-model="editForm.name"
                                       required>
                            </div>
                            <div class="mb-4">
                                <label for="edit-document-version" class="tw-form-label">
                                    Version <span class="text-danger">*</span>
                                </label>
                                <input type="text"
                                       class="tw-form-input"
                                       id="edit-document-version"
                                       name="version"
                                       x-model="editForm.version"
                                       required>
                            </div>
                            <div class="mb-4">
                                <label for="edit-document-type" class="tw-form-label">
                                    Document Type <span class="text-danger">*</span>
                                </label>
                                <select class="tw-form-select"
                                        id="edit-document-type"
                                        name="document_type"
                                        x-model="editForm.document_type"
                                        required>
                                    <option value="">Select a type...</option>
                                    {% for value, label in document_type_choices %}<option value="{{ value }}">{{ label }}</option>{% endfor %}
                                </select>
                            </div>
                            <div>
                                <label for="edit-document-description" class="tw-form-label">Description</label>
                                <textarea class="tw-form-input"
                                          id="edit-document-description"
                                          name="description"
                                          rows="3"
                                          x-model="editForm.description"></textarea>
                            </div>
                        </div>
                        <div class="tw-modal-footer">
                            <button type="button" class="tw-btn-ghost" @click="open = false">Cancel</button>
                            <button type="submit" class="tw-btn-primary">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </template>
</div>
