import Alpine from 'alpinejs';

/**
 * Vulnerability Chart Component
 * Manages chart instance state for vulnerability trends
 * Chart.js is lazy-loaded when needed via vulnerability-chart-init
 * 
 * Usage:
 *   <div x-data="vulnerabilityChart()" x-init="$nextTick(() => { initVulnerabilityChart($el) })">
 */
export function registerVulnerabilityChart(): void {
    Alpine.data('vulnerabilityChart', () => {
        return {
            chartInstance: null as unknown,
            
            setChartInstance(instance: unknown): void {
                this.chartInstance = instance;
            },
            
            destroyChart(): void {
                if (this.chartInstance && typeof (this.chartInstance as { destroy?: () => void }).destroy === 'function') {
                    (this.chartInstance as { destroy: () => void }).destroy();
                    this.chartInstance = null;
                }
            }
        };
    });
}

// Chart initialization is lazy-loaded - don't import here
// It will be loaded when initVulnerabilityChart is called

// Auto-register when imported
registerVulnerabilityChart();
