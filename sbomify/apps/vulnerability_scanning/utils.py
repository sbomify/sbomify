"""Shared utilities for vulnerability scanning."""


def extract_severity_counts(result_json: dict | None) -> dict[str, int]:
    """Extract severity counts from an AssessmentRun result JSON blob.

    Args:
        result_json: The ``result`` field from an :class:`AssessmentRun`,
            expected to have ``summary.total_findings`` and
            ``summary.by_severity.{critical,high,medium,low,info}``.

    Returns:
        Dictionary with keys ``total``, ``critical``, ``high``, ``medium``,
        ``low``, and ``info`` â€” all defaulting to ``0`` when absent.
    """
    if not result_json:
        return {"total": 0, "critical": 0, "high": 0, "medium": 0, "low": 0, "info": 0}
    summary = result_json.get("summary", {})
    by_severity = summary.get("by_severity", {})
    return {
        "total": summary.get("total_findings", 0),
        "critical": by_severity.get("critical", 0),
        "high": by_severity.get("high", 0),
        "medium": by_severity.get("medium", 0),
        "low": by_severity.get("low", 0),
        "info": by_severity.get("info", 0),
    }
