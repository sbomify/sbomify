<!-- Workspace Billing Section using Standard Card Pattern -->
<!-- Current Plan Overview Card -->
<div class="mt-3 mb-4">
    <div class="card border-light shadow-brand">
        <div class="card-header px-4 py-3">
            <div class="d-flex justify-content-between align-items-center w-100">
                <h4 class="card-title mb-0">
                    <i class="fas fa-credit-card me-3 text-primary"></i>
                    Current Plan
                </h4>
                <div class="d-flex align-items-center gap-2">
                    {% if team.billing_plan == 'enterprise' %}
                        <span class="badge bg-purple-subtle text-purple px-3 py-2 fs-6">
                            <i class="fas fa-building me-1"></i>Enterprise
                        </span>
                    {% elif team.billing_plan == 'business' %}
                        <span class="badge bg-primary-subtle text-primary px-3 py-2 fs-6">
                            <i class="fas fa-rocket me-1"></i>Business
                        </span>
                    {% else %}
                        <span class="badge bg-info-subtle text-info px-3 py-2 fs-6">
                            <i class="fas fa-heart me-1"></i>Community
                        </span>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="card-body p-4">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h3 class="mb-2">
                        {% if team.billing_plan == 'enterprise' %}
                            Enterprise Plan
                        {% elif team.billing_plan == 'business' %}
                            Business Plan
                        {% else %}
                            Community Plan
                        {% endif %}
                    </h3>
                    <p class="text-muted mb-3">
                        {% if team.billing_plan == 'enterprise' %}
                            Unlimited power for large organizations with custom integrations and dedicated support.
                        {% elif team.billing_plan == 'business' %}
                            Advanced tools for growing teams with priority support and enhanced features.
                        {% else %}
                            Perfect for getting started with essential SBOM management features.
                        {% endif %}
                    </p>
                    <!-- Plan Pricing -->
                    <div class="d-flex align-items-baseline gap-2 mb-3">
                        <span class="display-6 fw-bold text-primary">
                            {% if team.billing_plan == 'enterprise' %}
                                Custom
                            {% elif team.billing_plan == 'business' %}
                                $199
                            {% else %}
                                $0
                            {% endif %}
                        </span>
                        <span class="text-muted">
                            {% if team.billing_plan == 'enterprise' %}
                                pricing
                            {% elif team.billing_plan == 'business' %}
                                /month
                            {% else %}
                                /forever
                            {% endif %}
                        </span>
                    </div>
                </div>
                <div class="col-md-4 text-md-end">
                    {% if user_role == 'owner' %}
                        <a href="{% url 'billing:select_plan' team_key=team.key %}"
                           class="btn btn-outline-primary btn-lg">
                            <i class="fas fa-{% if team.billing_plan == 'community' or not team.billing_plan %}arrow-up{% else %}exchange-alt{% endif %} me-2"></i>
                            {% if team.billing_plan == 'community' or not team.billing_plan %}
                                Upgrade Plan
                            {% else %}
                                Change Plan
                            {% endif %}
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Resource Limits and Features Grid -->
<div class="row g-4">
    <!-- Resource Limits Card -->
    <div class="col-lg-6">
        <div class="card border-light shadow-brand h-100">
            <div class="card-header px-4 py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-chart-bar me-2 text-success"></i>
                        Resource Limits
                    </h5>
                    {% if team.billing_plan == 'enterprise' %}
                        <span class="badge bg-success-subtle text-success">
                            <i class="fas fa-infinity me-1"></i>Unlimited
                        </span>
                    {% endif %}
                </div>
            </div>
            <div class="card-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <div class="d-flex align-items-center p-3 bg-light rounded-3">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center"
                                     style="width: 48px;
                                            height: 48px">
                                    <i class="fas fa-cube text-white"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">Products</h6>
                                <div class="fs-4 fw-bold text-primary">
                                    {% if team.billing_plan_limits.max_products is None %}
                                        ∞
                                    {% else %}
                                        {{ team.billing_plan_limits.max_products }}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center p-3 bg-light rounded-3">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-info d-flex align-items-center justify-content-center"
                                     style="width: 48px;
                                            height: 48px">
                                    <i class="fas fa-folder text-white"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">Projects</h6>
                                <div class="fs-4 fw-bold text-info">
                                    {% if team.billing_plan_limits.max_projects is None %}
                                        ∞
                                    {% else %}
                                        {{ team.billing_plan_limits.max_projects }}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center p-3 bg-light rounded-3">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-success d-flex align-items-center justify-content-center"
                                     style="width: 48px;
                                            height: 48px">
                                    <i class="fas fa-puzzle-piece text-white"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">Components</h6>
                                <div class="fs-4 fw-bold text-success">
                                    {% if team.billing_plan_limits.max_components is None %}
                                        ∞
                                    {% else %}
                                        {{ team.billing_plan_limits.max_components }}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Plan Features Card -->
    <div class="col-lg-6">
        <div class="card border-light shadow-brand h-100">
            <div class="card-header px-4 py-3">
                <h5 class="card-title mb-0">
                    <i class="fas fa-star me-2 text-warning"></i>
                    Plan Features
                </h5>
            </div>
            <div class="card-body p-4">
                <div class="d-flex flex-column gap-3">
                    {% if team.billing_plan == 'enterprise' %}
                        <div class="d-flex align-items-center">
                            <i class="fas fa-check-circle text-success me-3"></i>
                            <span>Everything in Business</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-infinity text-success me-3"></i>
                            <span>Unlimited resources</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-key text-success me-3"></i>
                            <span>SSO integration</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-shield-alt text-success me-3"></i>
                            <span>Advanced security</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-headset text-success me-3"></i>
                            <span>Priority support</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-puzzle-piece text-success me-3"></i>
                            <span>Custom integrations</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-user-tie text-success me-3"></i>
                            <span>Dedicated account manager</span>
                        </div>
                    {% elif team.billing_plan == 'business' %}
                        <div class="d-flex align-items-center">
                            <i class="fas fa-microscope text-primary me-3"></i>
                            <span>Advanced SBOM analysis</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-shield-virus text-primary me-3"></i>
                            <span>Advanced vulnerability scanning</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-code text-primary me-3"></i>
                            <span>API access</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-headset text-primary me-3"></i>
                            <span>Priority support</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-palette text-primary me-3"></i>
                            <span>Custom branding</span>
                        </div>
                    {% else %}
                        <div class="d-flex align-items-center">
                            <i class="fas fa-file-alt text-info me-3"></i>
                            <span>Basic SBOM management</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-search text-info me-3"></i>
                            <span>Vulnerability scanning (daily)</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-users text-info me-3"></i>
                            <span>Community support</span>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Subscription Status Card -->
{% if team.billing_plan_limits and team.billing_plan_limits.subscription_status %}
    <div class="mt-4">
        <div class="card border-light shadow-brand">
            <div class="card-header px-4 py-3">
                <h5 class="card-title mb-0">
                    <i class="fas fa-info-circle me-2 text-info"></i>
                    Subscription Status
                </h5>
            </div>
            <div class="card-body p-4">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0 me-4">
                        <div class="rounded-circle d-flex align-items-center justify-content-center {% if team.billing_plan_limits.subscription_status == 'active' %}bg-success{% elif team.billing_plan_limits.subscription_status == 'trialing' %}bg-primary{% else %}bg-warning{% endif %}"
                             style="width: 60px;
                                    height: 60px">
                            <i class="fas fa-{% if team.billing_plan_limits.subscription_status == 'active' %}check-circle{% elif team.billing_plan_limits.subscription_status == 'trialing' %}clock{% else %}exclamation-circle{% endif %} text-white fs-4"></i>
                        </div>
                    </div>
                    <div class="flex-grow-1">
                        <h5 class="mb-2">
                            {% if team.billing_plan_limits.subscription_status == 'active' %}
                                Active Subscription
                            {% elif team.billing_plan_limits.subscription_status == 'trialing' %}
                                Trial Period
                            {% else %}
                                {{ team.billing_plan_limits.subscription_status|title }}
                            {% endif %}
                        </h5>
                        <p class="text-muted mb-0">
                            {% if team.billing_plan_limits.is_trial %}
                                Your trial ends on {{ team.billing_plan_limits.trial_end|date:"F d, Y" }}
                            {% else %}
                                Your subscription is active and all features are available
                            {% endif %}
                        </p>
                    </div>
                    <div class="flex-shrink-0">
                        <span class="badge {% if team.billing_plan_limits.subscription_status == 'active' %}bg-success{% elif team.billing_plan_limits.subscription_status == 'trialing' %}bg-primary{% else %}bg-warning{% endif %} px-3 py-2 fs-6">
                            {% if team.billing_plan_limits.subscription_status == 'active' %}
                                Active
                            {% elif team.billing_plan_limits.subscription_status == 'trialing' %}
                                Trial
                            {% else %}
                                {{ team.billing_plan_limits.subscription_status|title }}
                            {% endif %}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}
<!-- Action Cards -->
{% if team.billing_plan == 'enterprise' %}
    <!-- Enterprise Contact Card -->
    <div class="mt-4">
        <div class="card border-primary shadow-brand">
            <div class="card-body p-4">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <div class="d-flex align-items-center mb-3">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center"
                                     style="width: 50px;
                                            height: 50px">
                                    <i class="fas fa-building text-white"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h5 class="mb-1">Enterprise Plan Active</h5>
                                <p class="text-muted mb-0">Custom integrations, priority support, and dedicated account management</p>
                            </div>
                        </div>
                        <p class="mb-0">
                            You have unlimited access to all sbomify features. Our enterprise team provides custom integrations, priority support, and dedicated account management.
                        </p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <a href="{% url 'billing:enterprise_contact' %}"
                           class="btn btn-primary btn-lg">
                            <i class="fas fa-envelope me-2"></i>
                            Contact Enterprise Team
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% elif team.billing_plan == 'community' or not team.billing_plan %}
    <!-- Upgrade Prompt Card -->
    <div class="mt-4">
        <div class="card border-primary shadow-brand">
            <div class="card-body p-4">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <div class="d-flex align-items-center mb-3">
                            <div class="flex-shrink-0 me-3">
                                <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center"
                                     style="width: 50px;
                                            height: 50px">
                                    <i class="fas fa-rocket text-white"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h5 class="mb-1">Ready to Scale Up?</h5>
                                <p class="text-muted mb-0">Advanced SBOM analysis, vulnerability scanning, API access, and priority support</p>
                            </div>
                        </div>
                        <p class="mb-0">
                            Unlock advanced SBOM analysis, vulnerability scanning, API access, and priority support with our Business plan.
                        </p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        {% if user_role == 'owner' %}
                            <div class="d-grid gap-2">
                                <a href="{% url 'billing:select_plan' team_key=team.key %}"
                                   class="btn btn-primary btn-lg">
                                    <i class="fas fa-arrow-up me-2"></i>
                                    Upgrade to Business
                                </a>
                                <a href="{% url 'billing:enterprise_contact' %}"
                                   class="btn btn-outline-primary">
                                    <i class="fas fa-building me-2"></i>
                                    Enterprise Sales
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}
<!-- Custom Purple Color for Enterprise Badge -->
<style>
.bg-purple-subtle {
    background-color: rgba(139, 92, 246, 0.1) !important;
}
.text-purple {
    color: #8b5cf6 !important;
}
</style>
